<?php 

$settings = require __DIR__ . "/../config/settings.php";

$char_encoding = $settings['app']['encoding'];

use App\Helpers;

?>
<!DOCTYPE html>
<html lang="<?=  htmlspecialchars($settings['app']['language'], ENT_QUOTES, $char_encoding); ?>">
<head>
  <meta charset="<?= htmlspecialchars($char_encoding, ENT_QUOTES, $char_encoding); ?>">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="data:image/x-icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///8C////QP///5H///+l////pf///6X///+l////pf///6X///+l////pf///6X///+l////pf///6X///+l////pf///6X///+l////kf///0D///8C////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///0T////m////////////////////////////////////////////////////////////////////////////////////////////////////5v///0T///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////kP/////////8////5f///+L////i////4v///+L////i////4v///+L////i////4v///+L////i////4v///+L////i////5f////z/////////kP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///+l/////////+X///83////G////x3///8d////Hf///x3///8d////Hf///x3///8d////Hf///x3///8d////Hf///xv///83////5f////////+l////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGhoaAP///6X/////////4v///x3///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///x3////i/////////6UBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaGhoA////pf/////////i////Hf///wAAAAAAAAAAAAAAAAAAAAAA////AP///xr///8a////AAAAAAAAAAAAAAAAAAAAAAD///8A////Hf///+L/////////pQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcXFwD///+S////6P///8j///8a////AAAAAAAAAAAAAAAAAP///wD///8h////tv///7b///8h////AAAAAAAAAAAAAAAAAP///wD///8a////yP///+j///+SAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAP///xP///8e////Gv///wP///8AAAAAAAAAAAD///8A////IP///7b//////////////7b///8g////AAAAAAAAAAAA////AP///wP///8a////Hv///xMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///yD///+2/////////////////////////7b///8g////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///8g////tv///////////////////////////////////7b///8g////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////IP///7b//////////v////P////+/////v////P////+/////////7b///8g////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///yL///+2///////////////D////iv////3////9////iv///8P//////////////7b///8i////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////XP////b/////////xP///yn///9Z//////////////9Z////Kf///8T/////////9v///1z///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///8K////h////7z///8q////AP///1r//////////////1r///8A////Kv///7z///+H////Cv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///8N////Gf///wD///8A////Wv//////////////Wv///wD///8A////Gf///w3///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///9a//////////////9a////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///1r//////////////1r///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////Wv//////////////Wv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///9a//////////////9a////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////AP///1r//////////////1r///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////Wv//////////////Wv///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD///86////pf///6X///86////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA///////////////////////////4AAAf+AAAH/gAAB/4AAAf+H/+H/h+fh/4fD4f+HgeH//wD///4Af//8AD//+AAf//gAH//4Qh///MM////D////w////8P////D////w////8P////D////////////////////////////8=">
  <title>download.sh</title>
  <meta name="description" content="File downloads">
  <link rel="stylesheet" href="./base.css">
  <link rel="preload" href="https://auth.dough10.me/public/css/user-menu.min.css" as="style">
  <script>
    window.files = <?= json_encode($files)?>
  </script>
</head>
<body>
  <div id="dls" class="dl-bg"></div>
  <div class="blink-container crt-state" aria-hidden="true">
    <pre class="blink-frame" id="frame1"></pre>
    <pre class="blink-frame" id="frame2"></pre>
    <pre class="blink-frame" id="frame3"></pre>
  </div>
  <header aria-label="Site header">
    <h1>
      download.sh
    </h1>
    <button
      aria-label="Open download history"
      title="Open download history"
      id="hist_but" 
      class="small-button">
      <svg 
        aria-hidden="true"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 -960 960 960"
        fill="currentColor">
        <path 
          d="M480-120q-138 0-240.5-91.5T122-440h82q14 104 92.5 172T480-200q117 0 198.5-81.5T760-480q0-117-81.5-198.5T480-760q-69 0-129 32t-101 88h110v80H120v-240h80v94q51-64 124.5-99T480-840q75 0 140.5 28.5t114 77q48.5 48.5 77 114T840-480q0 75-28.5 140.5t-77 114q-48.5 48.5-114 77T480-120Zm112-192L440-464v-216h80v184l128 128-56 56Z"/>
      </svg>
    </button> 
  </header>
  <main>
    <ul></ul>
  </main>
  <input type="text">
  <footer>
    <svg 
      aria-hidden="true" 
      class="margin-right-8" 
      xmlns="http://www.w3.org/2000/svg" 
      viewBox="0 0 100 100">
      <title>GitHub Logo</title>
      <path 
        fill-rule="evenodd" 
        clip-rule="evenodd" 
        fill="currentColor" 
        d="M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z"/>
    </svg>
    <a 
      href="https://github.com/dough10" 
      rel="noopener noreferrer" 
      target="_blank" 
      aria-label="Visit my GitHub profile">
      github.com/dough10
    </a>
  </footer>
  <dialog
    id="history" 
    aria-label="A log of files downloaded">
    <h2>History</h2>
    <button 
      autofocus
      aria-label="Close"
      title="Close"
      class="close small-button">
      <svg viewBox="0 0 24 24">
        <path 
          fill="currentColor"
          d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
      </svg>
    </button>
    <button 
      title="Clear download history"
      aria-label="Clear download history"
      class="button clear" 
      noshadow>
      clear
    </button>
    <ul>
<?php 
if ($downloadList) {
  foreach (array_reverse($downloadList) as $dl) {
    $escaped_dl = htmlspecialchars($dl['name'], ENT_QUOTES, $char_encoding);
    $escaped_status = htmlspecialchars($dl['status'], ENT_QUOTES, $char_encoding);
    $escaped_ndx = htmlspecialchars($dl['id'], ENT_QUOTES, $char_encoding);
?>
      <li data-ndx="<?= $escaped_ndx; ?>">
        <strong><?= $escaped_dl; ?></strong>
        <span><?= $escaped_status; ?></span>
      </li>
<?php
  }
}
?>
    </ul>
  </dialog>
  <button 
    class="to-top small-button"
    disabled title="Scroll to top"
    aria-disabled="true">
    <svg viewBox="0 0 24 24">
      <path
        fill="currentColor"
        d="M15,20H9V12H4.16L12,4.16L19.84,12H15V20Z"/>
    </svg>
  </button>
  <user-menu 
    email="<?= htmlspecialchars($email, ENT_QUOTES, $char_encoding); ?>"
    name="<?= htmlspecialchars($name, ENT_QUOTES, $char_encoding); ?>"
    picture="<?= htmlspecialchars($picture, ENT_QUOTES, $char_encoding); ?>"
    grantsaccess='<?= htmlspecialchars(json_encode($grantsaccess), ENT_QUOTES, $char_encoding); ?>'
  ></user-menu>
  <script type="module" src="./app.js" async></script>
</body>
</html>